<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ï–∫—Å–ø–µ—Ä—Ç–Ω–∞ —Å–∏—Å—Ç–µ–º–∞: –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫—ñ–º–Ω–∞—Ç–Ω–∏—Ö —Ä–æ—Å–ª–∏–Ω</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #2c5530, #4a7c59);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
            min-height: 500px;
        }

        .interaction-panel {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid #28a745;
        }

        .system-state {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid #007bff;
        }

        .question-area {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            min-height: 120px;
        }

        .question {
            font-size: 1.3em;
            font-weight: 600;
            color: #2c5530;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-yes {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }

        .btn-no {
            background: linear-gradient(45deg, #dc3545, #fd7e14);
            color: white;
        }

        .btn-restart {
            background: linear-gradient(45deg, #6c757d, #495057);
            color: white;
            margin-top: 15px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .facts-section, .trace-section, .conclusion-section {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 1.2em;
            font-weight: 700;
            color: #2c5530;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title::before {
            content: "üîç";
            font-size: 1.2em;
        }

        .facts-section .section-title::before { content: "üìã"; }
        .trace-section .section-title::before { content: "üîÑ"; }
        .conclusion-section .section-title::before { content: "üí°"; }

        .fact-item {
            background: #e8f5e8;
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 15px;
            border-left: 3px solid #28a745;
            font-weight: 500;
        }

        .trace-item {
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 5px;
            font-size: 0.95em;
        }

        .trace-check {
            background: #fff3cd;
            border-left: 3px solid #ffc107;
        }

        .trace-fire {
            background: #d1ecf1;
            border-left: 3px solid #17a2b8;
            font-weight: 600;
        }

        .conclusion {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .knowledge-base {
            background: #f8f9fa;
            padding: 30px;
            border-top: 3px solid #6c757d;
        }

        .kb-title {
            font-size: 1.5em;
            font-weight: 700;
            color: #2c5530;
            margin-bottom: 20px;
            text-align: center;
        }

        .rule-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #6c757d;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .rule-condition {
            color: #007bff;
            font-weight: 600;
        }

        .rule-conclusion {
            color: #28a745;
            font-weight: 600;
        }

        .empty-state {
            color: #6c757d;
            font-style: italic;
            text-align: center;
            padding: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–∏—Å—Ç–µ–º–∏ -->
        <div class="header">
            <h1>üå± –ï–∫—Å–ø–µ—Ä—Ç–Ω–∞ —Å–∏—Å—Ç–µ–º–∞</h1>
            <p>–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –∑ –∫—ñ–º–Ω–∞—Ç–Ω–∏–º–∏ —Ä–æ—Å–ª–∏–Ω–∞–º–∏</p>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <!-- –ü–∞–Ω–µ–ª—å –≤–∑–∞—î–º–æ–¥—ñ—ó -->
            <div class="interaction-panel">
                <h2 class="section-title">–î—ñ–∞–ª–æ–≥ –∑ —Å–∏—Å—Ç–µ–º–æ—é</h2>
                
                <div class="question-area">
                    <div class="question" id="question-text">
                        –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–†–æ–∑–ø–æ—á–∞—Ç–∏ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É", —â–æ–± –ø–æ—á–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –∑ –µ–∫—Å–ø–µ—Ä—Ç–Ω–æ—é —Å–∏—Å—Ç–µ–º–æ—é.
                    </div>
                    <div class="buttons" id="answer-buttons">
                        <button class="btn btn-restart" onclick="startDiagnosis()">–†–æ–∑–ø–æ—á–∞—Ç–∏ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É</button>
                    </div>
                </div>
            </div>

            <!-- –°—Ç–∞–Ω —Å–∏—Å—Ç–µ–º–∏ -->
            <div class="system-state">
                <h2 class="section-title">–°—Ç–∞–Ω —Å–∏—Å—Ç–µ–º–∏</h2>
                
                <!-- –í—ñ–¥–æ–º—ñ —Ñ–∞–∫—Ç–∏ -->
                <div class="facts-section">
                    <div class="section-title">–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–∫—Ç–∏</div>
                    <div id="facts-list" class="empty-state">–§–∞–∫—Ç–∏ —â–µ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ</div>
                </div>

                <!-- –•—ñ–¥ –º—ñ—Ä–∫—É–≤–∞–Ω—å -->
                <div class="trace-section">
                    <div class="section-title">–•—ñ–¥ –º—ñ—Ä–∫—É–≤–∞–Ω—å</div>
                    <div id="trace-list" class="empty-state">–ú—ñ—Ä–∫—É–≤–∞–Ω–Ω—è —â–µ –Ω–µ —Ä–æ–∑–ø–æ—á–∞—Ç—ñ</div>
                </div>

                <!-- –í–∏—Å–Ω–æ–≤–æ–∫ -->
                <div class="conclusion-section">
                    <div class="section-title">–î—ñ–∞–≥–Ω–æ–∑ —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</div>
                    <div id="conclusion-text" class="empty-state">–î—ñ–∞–≥–Ω–æ–∑ –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø—ñ—Å–ª—è –∞–Ω–∞–ª—ñ–∑—É</div>
                </div>
            </div>
        </div>

        <!-- –ë–∞–∑–∞ –∑–Ω–∞–Ω—å -->
        <div class="knowledge-base">
            <h2 class="kb-title">üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω—å —Å–∏—Å—Ç–µ–º–∏</h2>
            <div id="rules-display"></div>
        </div>
    </div>

    <script>
        /**
         * –ï–ö–°–ü–ï–†–¢–ù–ê –°–ò–°–¢–ï–ú–ê –î–õ–Ø –î–Ü–ê–ì–ù–û–°–¢–ò–ö–ò –ö–Ü–ú–ù–ê–¢–ù–ò–• –†–û–°–õ–ò–ù
         * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–µ—Ö–∞–Ω—ñ–∑–º –ø—Ä—è–º–æ–≥–æ –ª–∞–Ω—Ü—é–∂–∫–∞ –º—ñ—Ä–∫—É–≤–∞–Ω—å (forward chaining)
         */

        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –¥–ª—è —Å—Ç–∞–Ω—É —Å–∏—Å—Ç–µ–º–∏
        let facts = [];              // –°–ø–∏—Å–æ–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—Ö —Ñ–∞–∫—Ç—ñ–≤
        let trace = [];              // –ñ—É—Ä–Ω–∞–ª —Ö–æ–¥—É –º—ñ—Ä–∫—É–≤–∞–Ω—å
        let currentQuestionIndex = 0; // –Ü–Ω–¥–µ–∫—Å –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–Ω—è
        let isCompleted = false;     // –ß–∏ –∑–∞–∫—ñ–Ω—á–µ–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

        /**
         * –ë–ê–ó–ê –ó–ù–ê–ù–¨: –ü–∏—Ç–∞–Ω–Ω—è –¥–ª—è –∑–±–æ—Ä—É –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö —Ñ–∞–∫—Ç—ñ–≤
         * –ö–æ–∂–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è –º–∞—î –∫–ª—é—á, —Ç–µ–∫—Å—Ç —Ç–∞ —Ñ–∞–∫—Ç–∏ –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π "—Ç–∞–∫"/"–Ω—ñ"
         */
        const questions = [
            {
                key: "yellow_leaves",
                text: "–ß–∏ —î –Ω–∞ —Ä–æ—Å–ª–∏–Ω—ñ –∂–æ–≤—Ç—ñ –ª–∏—Å—Ç—è?",
                factYes: "–ª–∏—Å—Ç—è –∂–æ–≤—Ç–µ",
                factNo: "–ª–∏—Å—Ç—è –∑–µ–ª–µ–Ω–µ"
            },
            {
                key: "brown_spots",
                text: "–ß–∏ —î –Ω–∞ –ª–∏—Å—Ç—ñ –∫–æ—Ä–∏—á–Ω–µ–≤—ñ –∞–±–æ —Ç–µ–º–Ω—ñ –ø–ª—è–º–∏?",
                factYes: "–∫–æ—Ä–∏—á–Ω–µ–≤—ñ –ø–ª—è–º–∏ –Ω–∞ –ª–∏—Å—Ç—ñ",
                factNo: "–ø–ª—è–º –Ω–∞ –ª–∏—Å—Ç—ñ –Ω–µ–º–∞—î"
            },
            {
                key: "soil_moisture",
                text: "–ß–∏ “ë—Ä—É–Ω—Ç —É –≥–æ—Ä—â–∏–∫—É –≤–æ–ª–æ–≥–∏–π –∞–±–æ –¥—É–∂–µ –º–æ–∫—Ä–∏–π?",
                factYes: "“ë—Ä—É–Ω—Ç –≤–æ–ª–æ–≥–∏–π",
                factNo: "“ë—Ä—É–Ω—Ç —Å—É—Ö–∏–π"
            },
            {
                key: "watering_frequency",
                text: "–ß–∏ –ø–æ–ª–∏–≤–∞—î—Ç–µ –≤–∏ —Ä–æ—Å–ª–∏–Ω—É —á–∞—Å—Ç—ñ—à–µ –Ω—ñ–∂ —Ä–∞–∑ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å?",
                factYes: "–ø–æ–ª–∏–≤ —á–∞—Å—Ç–∏–π",
                factNo: "–ø–æ–ª–∏–≤ —Ä—ñ–¥–∫–∏–π"
            },
            {
                key: "light_conditions",
                text: "–ß–∏ —Å—Ç–æ—ó—Ç—å —Ä–æ—Å–ª–∏–Ω–∞ —É —Ç–µ–º–Ω–æ–º—É –º—ñ—Å—Ü—ñ (–º–∞–ª–æ –ø—Ä–∏—Ä–æ–¥–Ω–æ–≥–æ —Å–≤—ñ—Ç–ª–∞)?",
                factYes: "–º–∞–ª–æ —Å–≤—ñ—Ç–ª–∞",
                factNo: "–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Å–≤—ñ—Ç–ª–∞"
            },
            {
                key: "leaf_dropping",
                text: "–ß–∏ –æ–ø–∞–¥–∞—é—Ç—å –ª–∏—Å—Ç—è –∑ —Ä–æ—Å–ª–∏–Ω–∏?",
                factYes: "–ª–∏—Å—Ç—è –æ–ø–∞–¥–∞—é—Ç—å",
                factNo: "–ª–∏—Å—Ç—è —Ç—Ä–∏–º–∞—é—Ç—å—Å—è –º—ñ—Ü–Ω–æ"
            }
        ];

        /**
         * –ë–ê–ó–ê –ó–ù–ê–ù–¨: –ü—Ä–∞–≤–∏–ª–∞ –≤–∏–≤–µ–¥–µ–Ω–Ω—è —É —Ñ–æ—Ä–º–∞—Ç—ñ "–Ø–ö–©–û-–¢–û"
         * –ö–æ–∂–Ω–µ –ø—Ä–∞–≤–∏–ª–æ –º–∞—î —É–º–æ–≤–∏ (conditions) —Ç–∞ –≤–∏—Å–Ω–æ–≤–æ–∫ (conclusion)
         */
        const rules = [
            {
                id: 1,
                conditions: ["–∫–æ—Ä–∏—á–Ω–µ–≤—ñ –ø–ª—è–º–∏ –Ω–∞ –ª–∏—Å—Ç—ñ"],
                conclusion: "–º–æ–∂–ª–∏–≤–µ –≥—Ä–∏–±–∫–æ–≤–µ –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–Ω—è",
                description: "–Ø–ö–©–û '–∫–æ—Ä–∏—á–Ω–µ–≤—ñ –ø–ª—è–º–∏ –Ω–∞ –ª–∏—Å—Ç—ñ' –¢–û '–º–æ–∂–ª–∏–≤–µ –≥—Ä–∏–±–∫–æ–≤–µ –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–Ω—è'"
            },
            {
                id: 2,
                conditions: ["–ª–∏—Å—Ç—è –∂–æ–≤—Ç–µ", "“ë—Ä—É–Ω—Ç –≤–æ–ª–æ–≥–∏–π"],
                conclusion: "–º–æ–∂–ª–∏–≤–∏–π –Ω–∞–¥–ª–∏—à–æ–∫ –≤–æ–ª–æ–≥–∏",
                description: "–Ø–ö–©–û '–ª–∏—Å—Ç—è –∂–æ–≤—Ç–µ' –Ü '“ë—Ä—É–Ω—Ç –≤–æ–ª–æ–≥–∏–π' –¢–û '–º–æ–∂–ª–∏–≤–∏–π –Ω–∞–¥–ª–∏—à–æ–∫ –≤–æ–ª–æ–≥–∏'"
            },
            {
                id: 3,
                conditions: ["–ª–∏—Å—Ç—è –∂–æ–≤—Ç–µ", "“ë—Ä—É–Ω—Ç —Å—É—Ö–∏–π"],
                conclusion: "–º–æ–∂–ª–∏–≤–∏–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –≤–æ–ª–æ–≥–∏",
                description: "–Ø–ö–©–û '–ª–∏—Å—Ç—è –∂–æ–≤—Ç–µ' –Ü '“ë—Ä—É–Ω—Ç —Å—É—Ö–∏–π' –¢–û '–º–æ–∂–ª–∏–≤–∏–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –≤–æ–ª–æ–≥–∏'"
            },
            {
                id: 4,
                conditions: ["–ø–æ–ª–∏–≤ —á–∞—Å—Ç–∏–π", "“ë—Ä—É–Ω—Ç –≤–æ–ª–æ–≥–∏–π"],
                conclusion: "–ø–µ—Ä–µ–∑–≤–æ–ª–æ–∂–µ–Ω–Ω—è",
                description: "–Ø–ö–©–û '–ø–æ–ª–∏–≤ —á–∞—Å—Ç–∏–π' –Ü '“ë—Ä—É–Ω—Ç –≤–æ–ª–æ–≥–∏–π' –¢–û '–ø–µ—Ä–µ–∑–≤–æ–ª–æ–∂–µ–Ω–Ω—è'"
            },
            {
                id: 5,
                conditions: ["–ª–∏—Å—Ç—è –æ–ø–∞–¥–∞—é—Ç—å", "–º–∞–ª–æ —Å–≤—ñ—Ç–ª–∞"],
                conclusion: "–Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—î –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è",
                description: "–Ø–ö–©–û '–ª–∏—Å—Ç—è –æ–ø–∞–¥–∞—é—Ç—å' –Ü '–º–∞–ª–æ —Å–≤—ñ—Ç–ª–∞' –¢–û '–Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—î –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è'"
            },
            {
                id: 6,
                conditions: ["–º–æ–∂–ª–∏–≤–µ –≥—Ä–∏–±–∫–æ–≤–µ –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–Ω—è", "“ë—Ä—É–Ω—Ç –≤–æ–ª–æ–≥–∏–π"],
                conclusion: "–≥—Ä–∏–±–æ–∫ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∑–≤–æ–ª–æ–∂–µ–Ω–Ω—è",
                description: "–Ø–ö–©–û '–º–æ–∂–ª–∏–≤–µ –≥—Ä–∏–±–∫–æ–≤–µ –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–Ω—è' –Ü '“ë—Ä—É–Ω—Ç –≤–æ–ª–æ–≥–∏–π' –¢–û '–≥—Ä–∏–±–æ–∫ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∑–≤–æ–ª–æ–∂–µ–Ω–Ω—è'"
            }
        ];

        /**
         * –ë–ê–ó–ê –ó–ù–ê–ù–¨: –û—Å—Ç–∞—Ç–æ—á–Ω—ñ –¥—ñ–∞–≥–Ω–æ–∑–∏ —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
         * –ö–æ–∂–µ–Ω –¥—ñ–∞–≥–Ω–æ–∑ –º–∞—î –∫–ª—é—á–æ–≤–∏–π —Ñ–∞–∫—Ç —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—é
         */
        const diagnoses = [
            {
                condition: "–≥—Ä–∏–±–æ–∫ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∑–≤–æ–ª–æ–∂–µ–Ω–Ω—è",
                diagnosis: "–ì—Ä–∏–±–∫–æ–≤–µ –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –Ω–∞–¥–ª–∏—à–æ–∫ –≤–æ–ª–æ–≥–∏",
                recommendation: "–ó–º–µ–Ω—à—ñ—Ç—å –ø–æ–ª–∏–≤, –≤–∏–¥–∞–ª—ñ—Ç—å —É—Ä–∞–∂–µ–Ω—ñ –ª–∏—Å—Ç—è, –∑–∞—Å—Ç–æ—Å—É–π—Ç–µ —Ñ—É–Ω–≥—ñ—Ü–∏–¥. –ó–∞–±–µ–∑–ø–µ—á—Ç–µ —Ö–æ—Ä–æ—à—É –≤–µ–Ω—Ç–∏–ª—è—Ü—ñ—é."
            },
            {
                condition: "–º–æ–∂–ª–∏–≤–µ –≥—Ä–∏–±–∫–æ–≤–µ –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–Ω—è",
                diagnosis: "–ì—Ä–∏–±–∫–æ–≤–µ –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–Ω—è",
                recommendation: "–í–∏–¥–∞–ª—ñ—Ç—å —É—Ä–∞–∂–µ–Ω—ñ –ª–∏—Å—Ç—è, –∑–∞—Å—Ç–æ—Å—É–π—Ç–µ —Ñ—É–Ω–≥—ñ—Ü–∏–¥, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —É–º–æ–≤–∏ —É—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–æ—Å–ª–∏–Ω–∏."
            },
            {
                condition: "–ø–µ—Ä–µ–∑–≤–æ–ª–æ–∂–µ–Ω–Ω—è",
                diagnosis: "–ù–∞–¥–ª–∏—à–æ–∫ –≤–æ–ª–æ–≥–∏",
                recommendation: "–ó–º–µ–Ω—à—ñ—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø–æ–ª–∏–≤—É, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥—Ä–µ–Ω–∞–∂, –¥–æ–∑–≤–æ–ª—å—Ç–µ “ë—Ä—É–Ω—Ç—É –ø—ñ–¥—Å–æ—Ö–Ω—É—Ç–∏ –º—ñ–∂ –ø–æ–ª–∏–≤–∞–º–∏."
            },
            {
                condition: "–º–æ–∂–ª–∏–≤–∏–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –≤–æ–ª–æ–≥–∏",
                diagnosis: "–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—ñ–π –ø–æ–ª–∏–≤",
                recommendation: "–ó–±—ñ–ª—å—à—ñ—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø–æ–ª–∏–≤—É, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –¥–æ–±—Ä–µ –≤–æ–¥–∞ –ø—Ä–æ–Ω–∏–∫–∞—î –≤ “ë—Ä—É–Ω—Ç."
            },
            {
                condition: "–Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—î –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è",
                diagnosis: "–ù–µ—Å—Ç–∞—á–∞ —Å–≤—ñ—Ç–ª–∞",
                recommendation: "–ü–µ—Ä–µ–º—ñ—Å—Ç—ñ—Ç—å —Ä–æ—Å–ª–∏–Ω—É –±–ª–∏–∂—á–µ –¥–æ –≤—ñ–∫–Ω–∞ –∞–±–æ –∑–∞–±–µ–∑–ø–µ—á—Ç–µ –¥–æ–¥–∞—Ç–∫–æ–≤–µ —à—Ç—É—á–Ω–µ –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è."
            }
        ];

        /**
         * –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–∏—Å—Ç–µ–º–∏ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
         */
        function initializeSystem() {
            displayRules();
            addTrace("–°–∏—Å—Ç–µ–º–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —Ç–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ —Ä–æ–±–æ—Ç–∏.");
        }

        /**
         * –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª –±–∞–∑–∏ –∑–Ω–∞–Ω—å –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ
         */
        function displayRules() {
            const rulesContainer = document.getElementById('rules-display');
            rulesContainer.innerHTML = '';
            
            rules.forEach(rule => {
                const ruleDiv = document.createElement('div');
                ruleDiv.className = 'rule-item';
                
                const ruleText = rule.description.replace(
                    /–Ø–ö–©–û (.+?) –¢–û (.+)/,
                    '–Ø–ö–©–û <span class="rule-condition">$1</span> –¢–û <span class="rule-conclusion">$2</span>'
                );
                
                ruleDiv.innerHTML = `<strong>–ü—Ä–∞–≤–∏–ª–æ ${rule.id}:</strong> ${ruleText}`;
                rulesContainer.appendChild(ruleDiv);
            });
        }

        /**
         * –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—É –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
         */
        function startDiagnosis() {
            // –°–∫–∏–¥–∞–Ω–Ω—è —Å—Ç–∞–Ω—É —Å–∏—Å—Ç–µ–º–∏
            facts = [];
            trace = [];
            currentQuestionIndex = 0;
            isCompleted = false;
            
            // –û—á–∏—â–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
            updateFactsDisplay();
            updateTraceDisplay();
            updateConclusionDisplay();
            
            addTrace("üöÄ –†–æ–∑–ø–æ—á–∞—Ç–æ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Ä–æ—Å–ª–∏–Ω–∏.");
            addTrace("–ó–±–∏—Ä–∞—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞...");
            
            // –ü–æ–∫–∞–∑–∞—Ç–∏ –ø–µ—Ä—à–µ –ø–∏—Ç–∞–Ω–Ω—è
            showNextQuestion();
        }

        /**
         * –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ
         */
        function showNextQuestion() {
            if (currentQuestionIndex >= questions.length) {
                // –í—Å—ñ –ø–∏—Ç–∞–Ω–Ω—è –∑–∞–¥–∞–Ω—ñ, –∑–∞–ø—É—Å–∫–∞—î–º–æ –º–µ—Ö–∞–Ω—ñ–∑–º –≤–∏–≤–µ–¥–µ–Ω–Ω—è
                runInferenceEngine();
                return;
            }

            const question = questions[currentQuestionIndex];
            const questionElement = document.getElementById('question-text');
            const buttonsElement = document.getElementById('answer-buttons');

            questionElement.textContent = question.text;
            
            buttonsElement.innerHTML = `
                <button class="btn btn-yes" onclick="answerQuestion(true)">–¢–∞–∫</button>
                <button class="btn btn-no" onclick="answerQuestion(false)">–ù—ñ</button>
                <button class="btn btn-restart" onclick="startDiagnosis()">–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏</button>
            `;
        }

        /**
         * –û–±—Ä–æ–±–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è
         * @param {boolean} isYes - —á–∏ –≤—ñ–¥–ø–æ–≤—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á "—Ç–∞–∫"
         */
        function answerQuestion(isYes) {
            const question = questions[currentQuestionIndex];
            const fact = isYes ? question.factYes : question.factNo;
            
            // –î–æ–¥–∞—î–º–æ —Ñ–∞–∫—Ç –¥–æ –±–∞–∑–∏ —Ñ–∞–∫—Ç—ñ–≤
            addFact(fact);
            addTrace(`–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥–ø–æ–≤—ñ–≤: ${isYes ? '–¢–ê–ö' : '–ù–Ü'} –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ ${question.key}`);
            
            currentQuestionIndex++;
            
            // –ü—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑–∞–ø—É—Å–∫–∞—î–º–æ –º–µ—Ö–∞–Ω—ñ–∑–º –≤–∏–≤–µ–¥–µ–Ω–Ω—è
            runInferenceEngine();
            
            // –ü–æ–∫–∞–∑—É—î–º–æ –Ω–∞—Å—Ç—É–ø–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è, —è–∫—â–æ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
            if (!isCompleted) {
                showNextQuestion();
            }
        }

        /**
         * –ú–ï–•–ê–ù–Ü–ó–ú –í–ò–í–ï–î–ï–ù–ù–Ø (Inference Engine)
         * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä—è–º–∏–π –ª–∞–Ω—Ü—é–∂–æ–∫ –º—ñ—Ä–∫—É–≤–∞–Ω—å –¥–ª—è –≤–∏–≤–µ–¥–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ñ–∞–∫—Ç—ñ–≤
         */
        function runInferenceEngine() {
            let newFactsAdded = true;
            
            // –ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ, –ø–æ–∫–∏ –¥–æ–¥–∞—é—Ç—å—Å—è –Ω–æ–≤—ñ —Ñ–∞–∫—Ç–∏
            while (newFactsAdded) {
                newFactsAdded = false;
                
                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–æ–∂–Ω–µ –ø—Ä–∞–≤–∏–ª–æ
                for (const rule of rules) {
                    addTrace(`üîç –ü–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª–æ ‚Ññ${rule.id}...`);
                    
                    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –≤—Å—ñ —É–º–æ–≤–∏ –ø—Ä–∞–≤–∏–ª–∞ –≤–∏–∫–æ–Ω–∞–Ω—ñ
                    const allConditionsMet = rule.conditions.every(condition => 
                        facts.includes(condition)
                    );
                    
                    // –Ø–∫—â–æ —É–º–æ–≤–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ —ñ –≤–∏—Å–Ω–æ–≤–æ–∫ —â–µ –Ω–µ –¥–æ–¥–∞–Ω–æ
                    if (allConditionsMet && !facts.includes(rule.conclusion)) {
                        addFact(rule.conclusion);
                        addTrace(`‚úÖ –ü—Ä–∞–≤–∏–ª–æ ‚Ññ${rule.id} —Å–ø—Ä–∞—Ü—é–≤–∞–ª–æ! –î–æ–¥–∞–Ω–æ —Ñ–∞–∫—Ç: "${rule.conclusion}"`);
                        newFactsAdded = true;
                    }
                }
            }
            
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –º–æ–∂–µ–º–æ –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ –¥—ñ–∞–≥–Ω–æ–∑
            checkForDiagnosis();
        }

        /**
         * –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –¥—ñ–∞–≥–Ω–æ–∑—É
         */
        function checkForDiagnosis() {
            for (const diagnosis of diagnoses) {
                if (facts.includes(diagnosis.condition)) {
                    completeDiagnosis(diagnosis);
                    return;
                }
            }
            
            // –Ø–∫—â–æ –ø–∏—Ç–∞–Ω–Ω—è –∑–∞–∫—ñ–Ω—á–∏–ª–∏—Å—è, –∞–ª–µ –¥—ñ–∞–≥–Ω–æ–∑ –Ω–µ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
            if (currentQuestionIndex >= questions.length && !isCompleted) {
                completeWithoutDiagnosis();
            }
        }

        /**
         * –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º –¥—ñ–∞–≥–Ω–æ–∑–æ–º
         * @param {Object} diagnosis - –æ–±'—î–∫—Ç –¥—ñ–∞–≥–Ω–æ–∑—É
         */
        function completeDiagnosis(diagnosis) {
            isCompleted = true;
            
            const questionElement = document.getElementById('question-text');
            const buttonsElement = document.getElementById('answer-buttons');
            
            questionElement.innerHTML = `
                <strong>üéØ –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</strong><br>
                –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–ª–∞ –≤—Å—ñ —Ñ–∞–∫—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏–ª–∞ –¥—ñ–∞–≥–Ω–æ–∑.
            `;
            
            buttonsElement.innerHTML = `
                <button class="btn btn-restart" onclick="startDiagnosis()">–ù–æ–≤–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</button>
            `;
            
            updateConclusionDisplay(`
                <div class="conclusion">
                    <h3>üìã –î—ñ–∞–≥–Ω–æ–∑: ${diagnosis.diagnosis}</h3>
                    <p><strong>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:</strong> ${diagnosis.recommendation}</p>
                </div>
            `);
            
            addTrace(`üèÅ –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –¥—ñ–∞–≥–Ω–æ–∑: "${diagnosis.diagnosis}"`);
        }

        /**
         * –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥—ñ–∞–≥–Ω–æ–∑—É
         */
        function completeWithoutDiagnosis() {
            isCompleted = true;
            
            const questionElement = document.getElementById('question-text');
            const buttonsElement = document.getElementById('answer-buttons');
            
            questionElement.innerHTML = `
                <strong>ü§î –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</strong><br>
                –ù–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∞–¥–∞–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–º–æ–≥–ª–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –¥—ñ–∞–≥–Ω–æ–∑.
            `;
            
            buttonsElement.innerHTML = `
                <button class="btn btn-restart" onclick="startDiagnosis()">–ù–æ–≤–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</button>
            `;
            
            updateConclusionDisplay(`
                <div style="background: #ffc107; color: #212529; padding: 20px; border-radius: 10px; text-align: center;">
                    <h3>‚ö†Ô∏è –ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç–∞–Ω</h3>
                    <p>–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Å–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç–∞ –∞–±–æ –Ω–∞–¥–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å—Ç–∞–Ω —Ä–æ—Å–ª–∏–Ω–∏.</p>
                </div>
            `);
            
            addTrace("‚ùì –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –¥—ñ–∞–≥–Ω–æ–∑ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ. –ü–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è.");
        }

        /**
         * –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Ñ–∞–∫—Ç—É –¥–æ –±–∞–∑–∏ —Ñ–∞–∫—Ç—ñ–≤
         * @param {string} fact - –Ω–æ–≤–∏–π —Ñ–∞–∫—Ç
         */
        function addFact(fact) {
            if (!facts.includes(fact)) {
                facts.push(fact);
                updateFactsDisplay();
            }
        }

        /**
         * –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É –¥–æ –∂—É—Ä–Ω–∞–ª—É –º—ñ—Ä–∫—É–≤–∞–Ω—å
         * @param {string} message - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è –∂—É—Ä–Ω–∞–ª—É
         */
        function addTrace(message) {
            trace.push(message);
            updateTraceDisplay();
        }

        /**
         * –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É —Ñ–∞–∫—Ç—ñ–≤
         */
        function updateFactsDisplay() {
            const factsElement = document.getElementById('facts-list');
            
            if (facts.length === 0) {
                factsElement.innerHTML = '<div class="empty-state">–§–∞–∫—Ç–∏ —â–µ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ</div>';
            } else {
                factsElement.innerHTML = facts.map(fact => 
                    `<div class="fact-item">‚úì ${fact}</div>`
                ).join('');
            }
        }

        /**
         * –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∂—É—Ä–Ω–∞–ª—É –º—ñ—Ä–∫—É–≤–∞–Ω—å
         */
        function updateTraceDisplay() {
            const traceElement = document.getElementById('trace-list');
            
            if (trace.length === 0) {
                traceElement.innerHTML = '<div class="empty-state">–ú—ñ—Ä–∫—É–≤–∞–Ω–Ω—è —â–µ –Ω–µ —Ä–æ–∑–ø–æ—á–∞—Ç—ñ</div>';
            } else {
                traceElement.innerHTML = trace.map(entry => {
                    const className = entry.includes('—Å–ø—Ä–∞—Ü—é–≤–∞–ª–æ') ? 'trace-fire' : 'trace-check';
                    return `<div class="trace-item ${className}">${entry}</div>`;
                }).join('');
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—Ä–æ–∫—Ä—É—á—É–≤–∞–Ω–Ω—è –¥–æ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∑–∞–ø–∏—Å—É
                traceElement.scrollTop = traceElement.scrollHeight;
            }
        }

        /**
         * –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–∏—Å–Ω–æ–≤–∫—É
         * @param {string} content - HTML –∫–æ–Ω—Ç–µ–Ω—Ç –≤–∏—Å–Ω–æ–≤–∫—É
         */
        function updateConclusionDisplay(content = null) {
            const conclusionElement = document.getElementById('conclusion-text');
            
            if (content) {
                conclusionElement.innerHTML = content;
            } else {
                conclusionElement.innerHTML = '<div class="empty-state">–î—ñ–∞–≥–Ω–æ–∑ –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø—ñ—Å–ª—è –∞–Ω–∞–ª—ñ–∑—É</div>';
            }
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–∏—Å—Ç–µ–º–∏ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.addEventListener('DOMContentLoaded', initializeSystem);
    </script>
</body>
</html>